@inject IJSRuntime JSRuntime

<div class="form-check form-switch">
    <input class="form-check-input" type="checkbox" id="darkModeToggle" @bind="IsDarkMode" @oninput="HandleInputChange">
    <label class="form-check-label" for="darkModeToggle">Dark Mode</label>
</div>

@code {
    private bool IsDarkMode;

    protected override async Task OnInitializedAsync()
    {
        IsDarkMode = await JSRuntime.InvokeAsync<bool?>("localStorage.getItem", "darkMode") ?? false;
        await SetTheme();
    }

    private async Task HandleInputChange(ChangeEventArgs e)
    {
        IsDarkMode = (bool)e.Value; // Get the correct value from ChangeEventArgs
        await SetTheme();
        await JSRuntime.InvokeVoidAsync("localStorage.setItem", "darkMode", IsDarkMode);
    }

    private async Task SetTheme()
    {
        if (IsDarkMode)
        {
            await JSRuntime.InvokeVoidAsync("document.body.classList.add", "dark-theme");
        }
        else
        {
            await JSRuntime.InvokeVoidAsync("document.body.classList.remove", "dark-theme");
        }
    }
}